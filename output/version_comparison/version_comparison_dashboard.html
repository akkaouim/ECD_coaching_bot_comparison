
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Version Comparison Dashboard - OCS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .card {
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border: 1px solid rgba(0, 0, 0, 0.125);
            margin-bottom: 1.5rem;
        }
        .card-header {
            background-color: #007bff;
            color: white;
            border-bottom: 1px solid rgba(0, 0, 0, 0.125);
        }
        .table th {
            background-color: #f8f9fa;
            border-top: none;
        }
        .table-dark th {
            background-color: #343a40 !important;
            color: #ffffff !important;
            font-weight: bold;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>
                Version Comparison Dashboard
            </a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="alert alert-info">
                    <h4 class="alert-heading">
                        <i class="fas fa-info-circle me-2"></i>
                        Dashboard Overview
                    </h4>
                    <p>This dashboard compares coaching bot versions based on session metrics, annotations, and user engagement.</p>
                    <hr>
                    <p class="mb-0">
                        <strong>Generated:</strong> 2025-10-24 14:28:30
                    </p>
                </div>
            </div>
        </div>



        <!-- Tab Navigation -->
        <div class="row mt-4">
            <div class="col-12">
                <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="summary-tab" data-bs-toggle="tab" data-bs-target="#summary" type="button" role="tab" aria-controls="summary" aria-selected="true">Summary</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="performance-tab" data-bs-toggle="tab" data-bs-target="#performance" type="button" role="tab" aria-controls="performance" aria-selected="false">Performance</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="engagement-tab" data-bs-toggle="tab" data-bs-target="#engagement" type="button" role="tab" aria-controls="engagement" aria-selected="false">User Engagement</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="definitions-tab" data-bs-toggle="tab" data-bs-target="#definitions" type="button" role="tab" aria-controls="definitions" aria-selected="false">Definitions</button>
                    </li>
                </ul>
                
                <div class="tab-content" id="dashboardTabContent">
                    <!-- Summary Tab -->
                    <div class="tab-pane fade show active" id="summary" role="tabpanel" aria-labelledby="summary-tab">
                     <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3>Summary Metrics by Version</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Coaching Bot Version</th>
                                        <th># Sessions</th>
                                        <th># Annotated Sessions</th>
                                        <th>Refrigeration Examples (%)</th>
                                        <th>Median Human Words per Session</th>
                                        <th>Average Session Rating</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    
                            <tr>
                                <td><strong>Coaching bot V3</strong></td>
                                <td>3355</td>
                                <td>0</td>
                                <td>0.0%</td>
                                <td>37.0</td>
                                <td>4.78</td>
                            </tr>
            
                            <tr>
                                <td><strong>Coaching bot V4</strong></td>
                                <td>2145</td>
                                <td>192</td>
                                <td>29.7%</td>
                                <td>46.0</td>
                                <td>4.85</td>
                            </tr>
            
                            <tr>
                                <td><strong>Coaching bot V5</strong></td>
                                <td>1291</td>
                                <td>62</td>
                                <td>37.1%</td>
                                <td>152.0</td>
                                <td>4.53</td>
                            </tr>
            
                            <tr>
                                <td><strong>Coaching bot V6</strong></td>
                                <td>1173</td>
                                <td>3</td>
                                <td>33.3%</td>
                                <td>121.0</td>
                                <td>4.64</td>
                            </tr>
            
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                    </div>
                    
                    <!-- Performance Tab -->
                    <div class="tab-pane fade" id="performance" role="tabpanel" aria-labelledby="performance-tab">
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Refrigerator Example Rate by Method and Version</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Method</th>
                                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr><td><strong>Scenario</strong></td><td>0.0%</td><td>100.0%</td><td>100.0%</td><td>0.0%</td></tr><tr><td><strong>Microlearning</strong></td><td>0.0%</td><td>72.3%</td><td>100.0%</td><td>0.0%</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>0.0%</td><td>0.0%</td><td>66.7%</td><td>0.0%</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>0.0%</td><td>62.5%</td><td>100.0%</td><td>100.0%</td></tr><tr><td><strong>Visit check in</strong></td><td>0.0%</td><td>100.0%</td><td>100.0%</td><td>0.0%</td></tr><tr><td><strong>Unknown</strong></td><td>0.0%</td><td>0.0%</td><td>0.0%</td><td>0.0%</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Average FLW Score by Method and Version</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Method</th>
                                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr><td><strong>Scenario</strong></td><td>-</td><td>4.77</td><td>4.46</td><td>4.56</td></tr><tr><td><strong>Microlearning</strong></td><td>-</td><td>4.84</td><td>4.55</td><td>4.61</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>-</td><td>-</td><td>4.47</td><td>4.64</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>-</td><td>4.87</td><td>4.69</td><td>4.70</td></tr><tr><td><strong>Visit check in</strong></td><td>4.20</td><td>4.94</td><td>4.64</td><td>4.68</td></tr><tr><td><strong>Unknown</strong></td><td>4.78</td><td>-</td><td>-</td><td>5.00</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <div class="mt-3">
                                            <small class="text-muted">
                                                <strong>Rating Collection Statistics:</strong><br>
                                                • Rating Questions: 75.1% of sessions (6009 out of 8001) contain rating questions<br>
                                                • Actual Ratings: 73.2% of sessions (5854 out of 8001) have extractable ratings
                                            </small>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Engagement Tab -->
                    <div class="tab-pane fade" id="engagement" role="tabpanel" aria-labelledby="engagement-tab">
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Median Number of Participant Messages per Session by Method and Version</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Method</th>
                                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr><td><strong>Scenario</strong></td><td>-</td><td>10.0</td><td>14.0</td><td>12.0</td></tr><tr><td><strong>Microlearning</strong></td><td>-</td><td>12.0</td><td>14.5</td><td>13.0</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>-</td><td>-</td><td>13.0</td><td>13.0</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>-</td><td>15.0</td><td>19.0</td><td>17.0</td></tr><tr><td><strong>Visit check in</strong></td><td>19.0</td><td>15.0</td><td>18.0</td><td>18.0</td></tr><tr><td><strong>Unknown</strong></td><td>9.0</td><td>2.0</td><td>-</td><td>9.0</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Median User Words per Session by Method and Version</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="excludeOutliers" onchange="toggleOutlierFilter()">
                                                <label class="form-check-label" for="excludeOutliers">
                                                    Exclude outlier sessions (sessions with >50 messages or >1000 words)
                                                </label>
                                            </div>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover" id="medianWordsTable">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Method</th>
                                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr><td><strong>Scenario</strong></td><td>0.0</td><td>83.5</td><td>151.0</td><td>128.5</td></tr><tr><td><strong>Microlearning</strong></td><td>0.0</td><td>76.0</td><td>122.0</td><td>89.0</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>0.0</td><td>0.0</td><td>93.5</td><td>90.5</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>0.0</td><td>81.0</td><td>167.5</td><td>129.0</td></tr><tr><td><strong>Visit check in</strong></td><td>102.0</td><td>130.0</td><td>209.5</td><td>176.0</td></tr><tr><td><strong>Unknown</strong></td><td>37.0</td><td>20.0</td><td>0.0</td><td>50.0</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Median User Words - Session Progression Analysis</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label for="progressionView" class="form-label">Select View:</label>
                                                    <select class="form-select" id="progressionView" onchange="updateProgressionChart()">
                                                        <option value="by_method">By Coaching Method</option>
                                                        <option value="by_method_version">By Coaching Method per Version</option>
                                                        <option value="by_version">By Version</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check mt-4">
                                                        <input class="form-check-input" type="checkbox" id="excludeOutliersProgression" onchange="updateProgressionChart()">
                                                        <label class="form-check-label" for="excludeOutliersProgression">
                                                            Exclude outlier sessions
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chart-container" style="position: relative; height: 400px;">
                                            <canvas id="progressionChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Definitions Tab -->
                    <div class="tab-pane fade" id="definitions" role="tabpanel" aria-labelledby="definitions-tab">
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h3>Definitions</h3>
                                    </div>
                                    <div class="card-body">
                                        <h5>Version Definitions</h5>
                                        <p>This dashboard compares four coaching bot versions based on experiment IDs and version ranges:</p>
                                        <ul>
                                            <li><strong>Coaching bot V3:</strong> Experiment IDs: E2b4855f-8550-47ff-87d2-d92018676ff3 or 1027993a-40c9-4484-a5fb-5c7e034dadcd (All versions)</li>
                                            <li><strong>Coaching bot V4:</strong> Experiment ID: b7621271-da98-459f-9f9b-f68335d09ad4 (Version 13 and above)</li>
                                            <li><strong>Coaching bot V5:</strong> Experiment ID: 5d8be75e-03ff-4e3a-ab6a-e0aff6580986 (Version 1 to 4)</li>
                                            <li><strong>Coaching bot V6:</strong> Experiment ID: 5d8be75e-03ff-4e3a-ab6a-e0aff6580986 (Version 5 and above)</li>
                                        </ul>
                                        
                                        <h5>Coaching Methods</h5>
                                        <p>Coaching methods are detected through a 3-tier approach:</p>
                                        <ul>
                                            <li><strong>Scenario:</strong> Roleplay and scenario-based coaching</li>
                                            <li><strong>Microlearning:</strong> Quiz and microlearning sessions</li>
                                            <li><strong>Microlearning vaccines:</strong> Vaccine-specific quiz sessions</li>
                                            <li><strong>Motivational interviewing:</strong> Motivational interview techniques</li>
                                            <li><strong>Visit check in:</strong> Home visit debrief sessions</li>
                                        </ul>
                                        
                                        <h5 class="mt-4">Average FLW Score by Method and Version</h5>
                                        <p>This metric shows the average session rating (1-5 scale) grouped by coaching method and bot version.</p>
                                        <ul>
                                            <li><strong>Calculation:</strong> Average of user ratings for sessions ending with "How useful did you find this coaching session? Please rate it from 1 to 5"</li>
                                            <li><strong>Rating Scale:</strong> 1 (not useful) to 5 (very useful)</li>
                                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                                            <li><strong>Version Detection:</strong> Based on experiment ID and version tags from last message</li>
                                            <li><strong>Purpose:</strong> Identify whether coaching methods receive higher ratings with bot evolution</li>
                                        </ul>
                                        
                                        <h5 class="mt-4">Median Number of Participant Messages per Session by Method and Version</h5>
                                        <p>This metric shows the median number of messages participants send per session, grouped by coaching method and bot version.</p>
                                        <ul>
                                            <li><strong>Calculation:</strong> Median count of user messages within a session</li>
                                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                                            <li><strong>Version Detection:</strong> Based on experiment ID and version tags from last message</li>
                                            <li><strong>Message Count:</strong> Total number of user messages in a session</li>
                                        </ul>
                                        
                                        <h5 class="mt-4">Median User Words per Session by Method and Version</h5>
                                        <p>This metric shows the median number of words users type per session, grouped by coaching method and bot version.</p>
                                        <ul>
                                            <li><strong>Calculation:</strong> Median word count of all user messages within a session</li>
                                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                                            <li><strong>Version Detection:</strong> Based on experiment ID and version tags from last message</li>
                                            <li><strong>Word Count:</strong> Total words across all user messages in a session</li>
                                            <li><strong>Outlier Filtering:</strong> Optional checkbox to exclude sessions with >50 messages or >1000 words</li>
                                        </ul>
                                        
                                        <h6>Session Numbering:</h6>
                                        <p>For line graph analysis, sessions are numbered chronologically per participant:</p>
                                        <ul>
                                            <li><strong>Participant ID:</strong> Based on participant.identifier field</li>
                                            <li><strong>Chronological Order:</strong> Sorted by session created_at timestamp</li>
                                            <li><strong>Session Number:</strong> Position in participant's session sequence (1st, 2nd, 3rd, etc.)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Progression data from server
        const progressionData = {"by_method": {"Scenario": {"1": 140.56521739130434, "6": 212.2434210526316, "10": 148.89655172413794, "14": 89.0, "18": 102.5, "22": 126.2, "2": 191.76315789473685, "8": 199.71428571428572, "9": 179.95652173913044, "11": 170.4862385321101, "16": 173.03508771929825, "21": 215.42857142857142, "3": 214.14814814814815, "4": 163.29166666666666, "5": 171.45283018867926, "17": 136.52941176470588, "7": 180.55263157894737, "15": 136.42857142857142, "19": 130.0, "13": 137.94117647058823, "20": 84.33333333333333, "12": 211.14285714285714}, "Microlearning": {"2": 155.79518072289156, "3": 73.3076923076923, "7": 315.56756756756755, "11": 76.5, "15": 154.32894736842104, "19": 126.66666666666667, "20": 197.31914893617022, "10": 182.1651376146789, "16": 80.16666666666667, "21": 73.375, "4": 116.8, "8": 107.2, "12": 118.0, "6": 124.22727272727273, "14": 120.47368421052632, "18": 193.13333333333333, "22": 160.83333333333334, "17": 110.0, "9": 51.333333333333336, "5": 189.89743589743588, "13": 76.0, "1": 36.86842105263158}, "Microlearning vaccines": {"4": 153.578125, "14": 186.64556962025316, "19": 129.95833333333334, "9": 197.9, "20": 55.666666666666664, "15": 69.0, "21": 86.0, "13": 106.2, "18": 84.5, "17": 219.0, "22": 322.0, "8": 51.0, "5": 58.0, "10": 121.0}, "Motivational interviewing": {"4": 199.0, "8": 233.81553398058253, "12": 124.72727272727273, "16": 123.42857142857143, "20": 137.0, "3": 231.72435897435898, "13": 229.92307692307693, "18": 164.72222222222223, "19": 183.33333333333334, "5": 99.75, "9": 137.8, "17": 117.28571428571429, "21": 130.25, "7": 128.05, "11": 118.9375, "15": 196.71428571428572, "14": 106.0, "6": 123.0, "10": 82.0, "22": 99.8, "1": 32.43956043956044}, "Visit check in": {"5": 280.0652173913044, "9": 240.25, "13": 135.25, "17": 388.55172413793105, "21": 207.66666666666666, "12": 260.8073394495413, "22": 262.95454545454544, "10": 1951.7777777777778, "18": 118.14285714285714, "6": 134.83333333333334, "14": 149.0, "4": 278.30434782608694, "8": 216.76190476190476, "16": 270.6842105263158, "20": 199.8125, "15": 138.4, "19": 176.75, "2": 256.4117647058824, "7": 442.17721518987344, "11": 199.28571428571428, "3": 472.0}, "Unknown": {"1": 36.77157360406091, "2": 69.77319587628865, "3": 61.56353591160221, "4": 69.5909090909091, "5": 58.20710059171598, "6": 51.05625, "7": 60.70886075949367, "8": 53.38709677419355, "9": 51.96026490066225, "10": 52.054054054054056, "11": 51.60958904109589, "12": 46.471014492753625, "13": 57.06106870229008, "14": 50.422764227642276, "15": 47.321100917431195, "16": 50.98936170212766, "17": 50.120879120879124, "18": 41.383720930232556, "19": 43.36470588235294, "20": 50.50632911392405, "21": 37.54054054054054, "22": 37.7}}, "by_method_version": {"Scenario_V3": {}, "Scenario_V4": {"1": 72.05, "6": 90.0, "10": 115.33333333333333, "14": 89.0, "18": 102.5, "22": 138.33333333333334, "7": 85.66666666666667, "11": 163.66666666666666, "15": 82.66666666666667, "19": 94.0, "5": 124.80952380952381, "9": 129.57894736842104, "13": 137.94117647058823, "17": 151.16666666666666, "21": 159.91666666666666, "16": 120.0, "20": 65.0, "2": 57.4, "3": 81.0, "8": 61.5, "12": 68.5}, "Scenario_V5": {"1": 191.08387096774194, "2": 199.36666666666667, "6": 214.3764705882353, "8": 208.0909090909091, "9": 215.40740740740742, "10": 157.65217391304347, "11": 186.27777777777777, "16": 177.5, "3": 219.26923076923077, "4": 163.29166666666666, "5": 202.0625, "7": 187.2941176470588, "12": 194.25, "17": 134.5, "15": 216.5}, "Scenario_V6": {"21": 230.5681818181818, "16": 174.9375, "17": 79.33333333333333, "22": 108.0, "11": 154.48076923076923, "6": 223.48333333333332, "1": 156.875, "20": 103.66666666666667, "19": 202.0, "15": 137.0, "2": 339.6666666666667, "7": 236.0, "12": 564.0}, "Microlearning_V3": {}, "Microlearning_V4": {"2": 90.6875, "3": 73.3076923076923, "7": 88.33333333333333, "11": 74.33333333333333, "15": 82.4, "19": 149.8, "4": 116.8, "8": 118.5, "12": 118.0, "16": 78.0, "20": 143.0, "6": 121.55, "10": 119.70588235294117, "14": 80.57142857142857, "18": 179.85714285714286, "22": 165.45454545454547, "17": 110.0, "21": 82.6, "9": 62.5, "5": 77.33333333333333, "13": 76.0, "1": 36.86842105263158}, "Microlearning_V5": {"7": 359.5483870967742, "15": 153.11764705882354, "2": 196.64705882352942, "10": 223.57894736842104, "5": 174.47826086956522, "11": 109.0, "16": 129.5, "14": 301.3333333333333, "6": 92.0, "9": 29.0, "8": 62.0}, "Microlearning_V6": {"20": 199.73333333333332, "15": 165.16216216216216, "16": 33.0, "21": 58.0, "10": 172.6851851851852, "5": 203.21153846153845, "22": 110.0, "19": 97.75, "18": 379.0, "14": 128.5, "6": 210.0, "11": 57.0}, "Microlearning vaccines_V3": {}, "Microlearning vaccines_V4": {}, "Microlearning vaccines_V5": {"4": 151.5529411764706, "14": 205.0681818181818, "9": 161.71794871794873, "15": 69.0, "13": 132.66666666666666, "8": 51.0, "5": 47.0}, "Microlearning vaccines_V6": {"19": 129.95833333333334, "14": 163.4857142857143, "20": 55.666666666666664, "9": 221.0327868852459, "4": 157.58139534883722, "21": 86.0, "18": 84.5, "17": 219.0, "22": 322.0, "13": 66.5, "5": 69.0, "10": 121.0}, "Motivational interviewing_V3": {}, "Motivational interviewing_V4": {"4": 141.8, "8": 111.75, "12": 106.33333333333333, "16": 91.16666666666667, "20": 135.0, "5": 99.75, "9": 178.33333333333334, "13": 72.33333333333333, "17": 85.66666666666667, "21": 85.0, "3": 143.16666666666666, "7": 128.05, "11": 118.9375, "15": 196.71428571428572, "19": 203.07142857142858, "14": 52.5, "18": 76.5, "6": 123.0, "10": 82.0, "22": 102.5, "1": 32.43956043956044}, "Motivational interviewing_V5": {"3": 263.69, "13": 269.1489361702128, "8": 258.0, "14": 159.5, "12": 171.5, "4": 81.0, "9": 85.0}, "Motivational interviewing_V6": {"18": 171.78, "13": 196.4878048780488, "19": 114.25, "8": 228.21875, "3": 198.25, "20": 142.0, "17": 141.0, "22": 89.0, "16": 317.0, "21": 266.0, "12": 48.0, "4": 603.0, "9": 69.0}, "Visit check in_V3": {"6": 137.5, "16": 103.0, "4": 101.0, "20": 65.0}, "Visit check in_V4": {"5": 89.33333333333333, "9": 240.25, "13": 123.0, "17": 129.16666666666666, "21": 194.0, "6": 143.0, "10": 130.0, "14": 149.0, "18": 165.0, "22": 155.66666666666666, "4": 286.3636363636364, "8": 209.8, "12": 165.875, "16": 296.57142857142856, "20": 156.28571428571428, "15": 67.25, "19": 118.66666666666667, "7": 87.0, "11": 51.0}, "Visit check in_V5": {"5": 308.675, "12": 328.375, "17": 176.75, "10": 2862.6666666666665, "2": 273.2542372881356, "7": 323.7, "13": 166.0, "11": 224.0, "16": 448.0, "3": 472.0, "6": 105.0}, "Visit check in_V6": {"22": 270.8048780487805, "17": 491.0, "18": 99.4, "12": 222.48888888888888, "7": 470.46268656716416, "2": 218.19230769230768, "16": 146.66666666666666, "21": 235.0, "19": 351.0, "15": 423.0, "20": 944.0, "8": 356.0, "13": 135.0}, "Unknown_V3": {"1": 69.3862433862434, "2": 71.94117647058823, "3": 62.22346368715084, "4": 71.06395348837209, "5": 58.862275449101794, "6": 51.68354430379747, "7": 61.0828025477707, "8": 53.701298701298704, "9": 52.63758389261745, "10": 52.38775510204081, "11": 52.18055555555556, "12": 47.11764705882353, "13": 57.69767441860465, "14": 51.231404958677686, "15": 48.09345794392523, "16": 51.494623655913976, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 51.76623376623377, "21": 38.513888888888886, "22": 38.89655172413793}, "Unknown_V4": {"1": 30.563947633434037, "2": 11.857142857142858, "3": 2.5, "4": 6.25, "19": 2.0, "20": 2.0, "21": 2.5, "22": 3.0, "9": 1.5, "11": 10.5, "12": 2.5, "13": 16.0, "14": 1.5, "15": 6.0, "17": 2.0, "5": 3.5, "6": 1.5, "16": 4.0, "7": 2.0, "8": 5.0, "10": 3.0}, "Unknown_V5": {}, "Unknown_V6": {"19": 50.0}}, "by_version": {"V3": {"1": 69.3862433862434, "2": 71.94117647058823, "3": 62.22346368715084, "4": 71.23699421965318, "5": 58.862275449101794, "6": 52.75625, "7": 61.0828025477707, "8": 53.701298701298704, "9": 52.63758389261745, "10": 52.38775510204081, "11": 52.18055555555556, "12": 47.11764705882353, "13": 57.69767441860465, "14": 51.231404958677686, "15": 48.09345794392523, "16": 52.04255319148936, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 51.93589743589744, "21": 38.513888888888886, "22": 38.89655172413793}, "V4": {"1": 34.90257648953301, "2": 74.36363636363636, "3": 111.875, "4": 211.61111111111111, "5": 105.41666666666667, "6": 110.69444444444444, "7": 110.125, "8": 169.19354838709677, "9": 136.2, "10": 114.35714285714286, "11": 104.0, "12": 131.07142857142858, "13": 117.32142857142857, "14": 82.35714285714286, "15": 131.96428571428572, "16": 200.73076923076923, "17": 122.3076923076923, "18": 144.96153846153845, "19": 159.23076923076923, "20": 128.76923076923077, "21": 129.53846153846155, "22": 135.56521739130434}, "V5": {"1": 191.08387096774194, "2": 229.5142857142857, "3": 256.23622047244095, "4": 153.47272727272727, "5": 238.26041666666666, "6": 211.71264367816093, "7": 276.68, "8": 228.71428571428572, "9": 179.9558823529412, "10": 437.2835820895522, "11": 188.72131147540983, "12": 307.5892857142857, "13": 257.3076923076923, "14": 209.10204081632654, "15": 149.89743589743588, "16": 184.48, "17": 170.71428571428572}, "V6": {"18": 163.38333333333333, "19": 130.32203389830508, "20": 198.03703703703704, "21": 218.45098039215685, "22": 257.39130434782606, "16": 168.97368421052633, "17": 430.4375, "13": 189.1818181818182, "14": 161.59459459459458, "15": 170.2, "8": 230.1846153846154, "9": 218.58064516129033, "10": 171.74545454545455, "11": 152.64150943396226, "12": 226.04255319148936, "6": 223.2622950819672, "7": 467.0147058823529, "1": 156.875, "2": 230.75862068965517, "3": 198.25, "4": 167.70454545454547, "5": 200.67924528301887}}};
        const progressionDataFiltered = {"by_method": {"Scenario": {"1": 133.6095890410959, "6": 180.13103448275862, "10": 148.89655172413794, "14": 89.0, "18": 102.5, "22": 126.2, "2": 159.4857142857143, "8": 192.0, "9": 179.95652173913044, "11": 156.42857142857142, "16": 156.83928571428572, "21": 173.3090909090909, "3": 163.65384615384616, "4": 163.29166666666666, "5": 171.45283018867926, "17": 136.52941176470588, "7": 179.05405405405406, "15": 136.42857142857142, "19": 130.0, "13": 137.94117647058823, "20": 84.33333333333333, "12": 152.33333333333334}, "Microlearning": {"2": 139.05128205128204, "3": 73.3076923076923, "7": 156.08333333333334, "11": 76.5, "15": 137.3783783783784, "19": 126.66666666666667, "20": 197.31914893617022, "10": 145.72115384615384, "16": 80.16666666666667, "21": 73.375, "4": 116.8, "8": 107.2, "12": 118.0, "6": 120.14285714285714, "14": 120.47368421052632, "18": 193.13333333333333, "22": 160.83333333333334, "17": 110.0, "9": 51.333333333333336, "5": 149.72602739726028, "13": 76.0, "1": 36.86842105263158}, "Microlearning vaccines": {"4": 122.55284552845528, "14": 139.77333333333334, "19": 129.95833333333334, "9": 136.19791666666666, "20": 55.666666666666664, "15": 69.0, "21": 86.0, "13": 106.2, "18": 84.5, "17": 219.0, "22": 322.0, "8": 51.0, "5": 47.0}, "Motivational interviewing": {"4": 96.6, "8": 172.4742268041237, "12": 124.72727272727273, "16": 123.42857142857143, "20": 137.0, "13": 190.4659090909091, "18": 164.72222222222223, "3": 167.18382352941177, "19": 129.1875, "5": 99.75, "9": 137.8, "17": 117.28571428571429, "21": 130.25, "7": 128.05, "11": 118.9375, "15": 176.53846153846155, "14": 106.0, "6": 123.0, "10": 82.0, "22": 99.8, "1": 32.43956043956044}, "Visit check in": {"5": 214.1590909090909, "9": 240.25, "13": 135.25, "17": 214.82142857142858, "21": 207.66666666666666, "12": 219.0952380952381, "22": 194.85, "10": 307.25, "18": 118.14285714285714, "6": 134.83333333333334, "14": 149.0, "4": 180.23809523809524, "8": 177.73684210526315, "16": 150.47058823529412, "20": 199.8125, "15": 138.4, "19": 176.75, "7": 214.68571428571428, "2": 226.98765432098764, "11": 199.28571428571428}, "Unknown": {"1": 36.563928873835735, "2": 56.84126984126984, "3": 54.89772727272727, "4": 54.64705882352941, "5": 57.07784431137725, "6": 51.05625, "7": 49.53896103896104, "8": 53.38709677419355, "9": 50.346666666666664, "10": 48.703448275862065, "11": 51.60958904109589, "12": 46.471014492753625, "13": 55.46923076923077, "14": 50.422764227642276, "15": 47.321100917431195, "16": 50.98936170212766, "17": 50.120879120879124, "18": 41.383720930232556, "19": 43.36470588235294, "20": 46.8974358974359, "21": 37.54054054054054, "22": 35.898305084745765}}, "by_method_version": {"Scenario_V3": {}, "Scenario_V4": {"1": 68.92436974789916, "6": 90.0, "10": 115.33333333333333, "14": 89.0, "18": 102.5, "22": 138.33333333333334, "7": 85.66666666666667, "15": 82.66666666666667, "19": 94.0, "5": 124.80952380952381, "9": 129.57894736842104, "13": 137.94117647058823, "17": 151.16666666666666, "21": 159.91666666666666, "16": 120.0, "20": 65.0, "2": 57.4, "3": 81.0, "8": 61.5, "12": 68.5, "11": 71.5}, "Scenario_V5": {"1": 181.5234899328859, "2": 178.14285714285714, "6": 180.0126582278481, "8": 200.15625, "9": 215.40740740740742, "10": 157.65217391304347, "11": 161.7450980392157, "16": 134.52380952380952, "3": 166.96, "4": 163.29166666666666, "5": 202.0625, "7": 187.2941176470588, "12": 194.25, "17": 134.5, "15": 216.5}, "Scenario_V6": {"21": 177.04651162790697, "16": 174.9375, "17": 79.33333333333333, "22": 108.0, "11": 154.48076923076923, "6": 190.98305084745763, "1": 156.875, "20": 103.66666666666667, "19": 202.0, "15": 137.0, "2": 153.5}, "Microlearning_V3": {}, "Microlearning_V4": {"2": 90.6875, "3": 73.3076923076923, "7": 88.33333333333333, "11": 74.33333333333333, "15": 82.4, "19": 149.8, "4": 116.8, "8": 118.5, "12": 118.0, "16": 78.0, "20": 143.0, "6": 121.55, "10": 98.6875, "14": 80.57142857142857, "18": 179.85714285714286, "22": 165.45454545454547, "17": 110.0, "21": 82.6, "9": 62.5, "5": 77.33333333333333, "13": 76.0, "1": 36.86842105263158}, "Microlearning_V5": {"7": 169.63333333333333, "15": 153.11764705882354, "2": 172.69565217391303, "10": 167.1891891891892, "5": 174.47826086956522, "11": 109.0, "16": 129.5, "14": 301.3333333333333, "6": 92.0, "9": 29.0, "8": 62.0}, "Microlearning_V6": {"20": 199.73333333333332, "15": 129.94285714285715, "16": 33.0, "21": 58.0, "10": 144.90196078431373, "5": 142.2340425531915, "22": 110.0, "19": 97.75, "18": 379.0, "14": 128.5, "11": 57.0}, "Microlearning vaccines_V3": {}, "Microlearning vaccines_V4": {}, "Microlearning vaccines_V5": {"4": 117.97560975609755, "14": 142.609756097561, "9": 149.26315789473685, "15": 69.0, "13": 132.66666666666666, "8": 51.0, "5": 47.0}, "Microlearning vaccines_V6": {"19": 129.95833333333334, "14": 136.35294117647058, "20": 55.666666666666664, "9": 127.63793103448276, "4": 131.70731707317074, "21": 86.0, "18": 84.5, "17": 219.0, "22": 322.0, "13": 66.5}, "Motivational interviewing_V3": {}, "Motivational interviewing_V4": {"4": 100.5, "8": 111.75, "12": 106.33333333333333, "16": 91.16666666666667, "20": 135.0, "5": 99.75, "9": 178.33333333333334, "13": 72.33333333333333, "17": 85.66666666666667, "21": 85.0, "3": 129.95652173913044, "7": 128.05, "11": 118.9375, "15": 176.53846153846155, "19": 134.16666666666666, "14": 52.5, "18": 76.5, "6": 123.0, "10": 82.0, "22": 102.5, "1": 32.43956043956044}, "Motivational interviewing_V5": {"13": 216.47826086956522, "8": 173.03125, "3": 175.6024096385542, "14": 159.5, "12": 171.5, "4": 81.0, "9": 85.0}, "Motivational interviewing_V6": {"18": 171.78, "13": 168.87179487179486, "19": 114.25, "8": 176.1639344262295, "3": 172.43333333333334, "20": 142.0, "17": 141.0, "22": 89.0, "16": 317.0, "21": 266.0, "12": 48.0, "9": 69.0}, "Visit check in_V3": {"6": 137.5, "16": 103.0, "4": 101.0, "20": 65.0}, "Visit check in_V4": {"5": 89.33333333333333, "9": 240.25, "13": 123.0, "17": 129.16666666666666, "21": 194.0, "6": 143.0, "10": 130.0, "14": 149.0, "18": 165.0, "22": 155.66666666666666, "4": 184.2, "8": 177.73684210526315, "12": 165.875, "16": 130.58333333333334, "20": 156.28571428571428, "15": 67.25, "19": 118.66666666666667, "7": 87.0, "11": 51.0}, "Visit check in_V5": {"5": 233.8684210526316, "12": 257.97777777777776, "17": 176.75, "10": 413.6, "7": 253.66666666666666, "13": 166.0, "2": 231.14545454545456, "11": 224.0, "16": 448.0, "6": 105.0}, "Visit check in_V6": {"22": 198.02702702702703, "17": 240.3684210526316, "18": 99.4, "12": 198.6818181818182, "7": 213.0677966101695, "2": 218.19230769230768, "16": 146.66666666666666, "21": 235.0, "19": 351.0, "15": 423.0, "20": 944.0, "13": 135.0}, "Unknown_V3": {"1": 68.25531914893617, "2": 58.57142857142857, "3": 55.5, "4": 55.81325301204819, "5": 57.72727272727273, "6": 51.68354430379747, "7": 49.849673202614376, "8": 53.701298701298704, "9": 51.00675675675676, "10": 49.020833333333336, "11": 52.18055555555556, "12": 47.11764705882353, "13": 56.0859375, "14": 51.231404958677686, "15": 48.09345794392523, "16": 51.494623655913976, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 48.078947368421055, "21": 38.513888888888886, "22": 37.05263157894737}, "Unknown_V4": {"1": 30.563947633434037, "2": 11.857142857142858, "3": 2.5, "4": 6.25, "19": 2.0, "20": 2.0, "21": 2.5, "22": 3.0, "9": 1.5, "11": 10.5, "12": 2.5, "13": 16.0, "14": 1.5, "15": 6.0, "17": 2.0, "5": 3.5, "6": 1.5, "16": 4.0, "7": 2.0, "8": 5.0, "10": 3.0}, "Unknown_V5": {}, "Unknown_V6": {"19": 50.0}}, "by_version": {"V3": {"1": 68.25531914893617, "2": 58.57142857142857, "3": 55.5, "4": 56.08383233532934, "5": 57.72727272727273, "6": 52.75625, "7": 49.849673202614376, "8": 53.701298701298704, "9": 51.00675675675676, "10": 49.020833333333336, "11": 52.18055555555556, "12": 47.11764705882353, "13": 56.0859375, "14": 51.231404958677686, "15": 48.09345794392523, "16": 52.04255319148936, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 48.298701298701296, "21": 38.513888888888886, "22": 37.05263157894737}, "V4": {"1": 34.57292506043513, "2": 74.36363636363636, "3": 103.28205128205128, "4": 142.27272727272728, "5": 105.41666666666667, "6": 110.69444444444444, "7": 110.125, "8": 147.53333333333333, "9": 136.2, "10": 101.70370370370371, "11": 94.96296296296296, "12": 131.07142857142858, "13": 117.32142857142857, "14": 82.35714285714286, "15": 119.85185185185185, "16": 109.75, "17": 122.3076923076923, "18": 144.96153846153845, "19": 121.125, "20": 128.76923076923077, "21": 129.53846153846155, "22": 135.56521739130434}, "V5": {"1": 181.5234899328859, "2": 198.7984496124031, "4": 127.79439252336448, "5": 206.5212765957447, "6": 178.0, "7": 188.21917808219177, "8": 182.65151515151516, "9": 173.16417910447763, "10": 182.76923076923077, "11": 167.27586206896552, "12": 246.64150943396226, "13": 209.5686274509804, "14": 153.69565217391303, "15": 149.89743589743588, "16": 147.16666666666666, "17": 170.71428571428572, "3": 173.60185185185185}, "V6": {"18": 163.38333333333333, "19": 130.32203389830508, "20": 198.03703703703704, "21": 172.18, "22": 192.0, "16": 168.97368421052633, "17": 220.7608695652174, "13": 163.1904761904762, "14": 135.91666666666666, "15": 138.02631578947367, "8": 176.1639344262295, "9": 126.64406779661017, "10": 144.90196078431373, "11": 152.64150943396226, "12": 195.33333333333334, "6": 190.98305084745763, "7": 213.0677966101695, "1": 156.875, "2": 213.57142857142858, "3": 172.43333333333334, "4": 131.70731707317074, "5": 142.2340425531915}}};
        
        let progressionChart = null;
        
        function updateProgressionChart() {
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Method</th>
                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>Scenario</strong></td><td>-</td><td>4.77</td><td>4.46</td><td>4.56</td></tr><tr><td><strong>Microlearning</strong></td><td>-</td><td>4.84</td><td>4.55</td><td>4.61</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>-</td><td>-</td><td>4.47</td><td>4.64</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>-</td><td>4.87</td><td>4.69</td><td>4.70</td></tr><tr><td><strong>Visit check in</strong></td><td>4.20</td><td>4.94</td><td>4.64</td><td>4.68</td></tr><tr><td><strong>Unknown</strong></td><td>4.78</td><td>-</td><td>-</td><td>5.00</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3>Median User Words per Session by Method and Version</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Method</th>
                                        <th>Coaching bot V3</th><th>Coaching bot V4</th><th>Coaching bot V5</th><th>Coaching bot V6</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td><strong>Scenario</strong></td><td>0.0</td><td>83.5</td><td>151.0</td><td>128.5</td></tr><tr><td><strong>Microlearning</strong></td><td>0.0</td><td>76.0</td><td>122.0</td><td>89.0</td></tr><tr><td><strong>Microlearning vaccines</strong></td><td>0.0</td><td>0.0</td><td>93.5</td><td>90.5</td></tr><tr><td><strong>Motivational interviewing</strong></td><td>0.0</td><td>81.0</td><td>167.5</td><td>129.0</td></tr><tr><td><strong>Visit check in</strong></td><td>102.0</td><td>130.0</td><td>209.5</td><td>176.0</td></tr><tr><td><strong>Unknown</strong></td><td>37.0</td><td>20.0</td><td>0.0</td><td>50.0</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3>Session Progression Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="progressionView" class="form-label">Select View:</label>
                            <select class="form-select" id="progressionView" onchange="updateProgressionChart()">
                                <option value="by_method">By Coaching Method</option>
                                <option value="by_method_version">By Method and Version</option>
                                <option value="by_version">By Version Only</option>
                            </select>
                        </div>
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="progressionChart"></canvas>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>X-axis:</strong> Session number (1st, 2nd, 3rd, etc. session for each participant)<br>
                                <strong>Y-axis:</strong> Average number of words per session<br>
                                <strong>Data:</strong> Limited to first 22 sessions per participant
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3>Definitions</h3>
                    </div>
                    <div class="card-body">
                        <h5>Coaching Bot Versions</h5>
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Version</th>
                                    <th>Experiment ID</th>
                                    <th>Version Range</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Coaching bot V3</strong></td>
                                    <td>E2b4855f-8550-47ff-87d2-d92018676ff3<br/>or 1027993a-40c9-4484-a5fb-5c7e034dadcd</td>
                                    <td>All versions</td>
                                </tr>
                                <tr>
                                    <td><strong>Coaching bot V4</strong></td>
                                    <td>b7621271-da98-459f-9f9b-f68335d09ad4</td>
                                    <td>13 and above</td>
                                </tr>
                                <tr>
                                    <td><strong>Coaching bot V5</strong></td>
                                    <td>5d8be75e-03ff-4e3a-ab6a-e0aff6580986</td>
                                    <td>1 to 4</td>
                                </tr>
                                <tr>
                                    <td><strong>Coaching bot V6</strong></td>
                                    <td>5d8be75e-03ff-4e3a-ab6a-e0aff6580986</td>
                                    <td>5 and above</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <h5 class="mt-4">Metric Definitions</h5>
                        <ul>
                            <li><strong>Sessions:</strong> Bot-initiated interactions excluding split sessions (sessions with no participant messages) and test sessions (participant ID ending with @dimagi.com)</li>
                            <li><strong>Annotated Sessions:</strong> Sessions with non-version tags</li>
                            <li><strong>Refrigeration Examples:</strong> Sessions with "refrigerator_example" tag</li>
                            <li><strong>Median Human Words:</strong> Median word count of user messages per session</li>
                            <li><strong>Average Session Rating:</strong> Mean rating (1-5) from user feedback</li>
                        </ul>
                        
                        <h5 class="mt-4">Data Quality and Filtering</h5>
                        <p>This dashboard applies comprehensive filtering to ensure data quality and consistency across all indicators:</p>
                        <ul>
                            <li><strong>Split Sessions Excluded:</strong> Sessions with no participant messages (bot-only interactions)</li>
                            <li><strong>Test Sessions Excluded:</strong> Sessions with participant IDs ending in @dimagi.com (internal testing)</li>
                            <li><strong>Consistent Filtering:</strong> All tables, graphs, and metrics use the same exclusion criteria</li>
                            <li><strong>Enhanced Rating Detection:</strong> Comprehensive pattern matching improves rating extraction from 0.07% to 68% of sessions</li>
                            <li><strong>Version Detection:</strong> Based on experiment IDs and version tags from the last message in each session</li>
                        </ul>
                        
                        <h5 class="mt-4">Refrigerator Example Rate by Method</h5>
                        <p>This metric shows the percentage of sessions with refrigerator examples within each coaching method.</p>
                        <ul>
                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                            <li><strong>Calculation:</strong> (Sessions with "refrigerator_example" tag) / (Sessions with refrigerator annotations) × 100</li>
                            <li><strong>Denominator:</strong> Sessions with "refrigerator_example" OR "not_refrigerator_example" tags</li>
                            <li><strong>Numerator:</strong> Sessions with "refrigerator_example" tag</li>
                        </ul>
                        
                        <h6>Coaching Methods:</h6>
                        <ul>
                            <li><strong>Scenario:</strong> Roleplay-based coaching sessions</li>
                            <li><strong>Microlearning:</strong> Quiz-based learning sessions</li>
                            <li><strong>Microlearning vaccines:</strong> Vaccine-specific quiz sessions</li>
                            <li><strong>Motivational interviewing:</strong> Motivational interview techniques</li>
                            <li><strong>Visit check in:</strong> Home visit debrief sessions</li>
                        </ul>
                        
                        <h5 class="mt-4">Average FLW Score by Method and Version</h5>
                        <p>This metric shows the average session rating (1-5 scale) grouped by coaching method and bot version.</p>
                        <ul>
                            <li><strong>Calculation:</strong> Average of user ratings using comprehensive pattern matching for rating questions and responses</li>
                            <li><strong>Rating Scale:</strong> 1 (not useful) to 5 (very useful)</li>
                            <li><strong>Rating Detection:</strong> Comprehensive pattern matching for various rating question formats and user response patterns</li>
                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                            <li><strong>Version Detection:</strong> Based on experiment ID and version tags from last message</li>
                            <li><strong>Purpose:</strong> Identify whether coaching methods receive higher ratings with bot evolution</li>
                            <li><strong>Data Coverage:</strong> ~68% of sessions have extractable ratings (vs. 0.07% with basic pattern matching)</li>
                            <li><strong>Rating Statistics:</strong> Dynamic footnotes show rating question coverage and extraction rates for transparency</li>
                        </ul>
                        
                        <h5 class="mt-4">Median User Words per Session by Method and Version</h5>
                        <p>This metric shows the median number of words users type per session, grouped by coaching method and bot version.</p>
                        <ul>
                            <li><strong>Calculation:</strong> Median word count of all user messages within a session</li>
                            <li><strong>Method Detection:</strong> Based on session tags (coach_method_*) or message content analysis</li>
                            <li><strong>Version Detection:</strong> Based on experiment ID and version tags from last message</li>
                            <li><strong>Word Count:</strong> Total words across all user messages in a session</li>
                        </ul>
                        
                        <h6>Session Numbering:</h6>
                        <p>For line graph analysis, sessions are numbered chronologically per participant:</p>
                        <ul>
                            <li><strong>Participant ID:</strong> Based on participant.identifier field</li>
                            <li><strong>Chronological Order:</strong> Sorted by session created_at timestamp</li>
                            <li><strong>Session Number:</strong> Position in participant's session sequence (1st, 2nd, 3rd, etc.)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Progression data from server
        const progressionData = {"by_method": {"Scenario": {"1": 140.56521739130434, "6": 212.2434210526316, "10": 148.89655172413794, "14": 89.0, "18": 102.5, "22": 126.2, "2": 191.76315789473685, "8": 199.71428571428572, "9": 179.95652173913044, "11": 170.4862385321101, "16": 173.03508771929825, "21": 215.42857142857142, "3": 214.14814814814815, "4": 163.29166666666666, "5": 171.45283018867926, "17": 136.52941176470588, "7": 180.55263157894737, "15": 136.42857142857142, "19": 130.0, "13": 137.94117647058823, "20": 84.33333333333333, "12": 211.14285714285714}, "Microlearning": {"2": 155.79518072289156, "3": 73.3076923076923, "7": 315.56756756756755, "11": 76.5, "15": 154.32894736842104, "19": 126.66666666666667, "20": 197.31914893617022, "10": 182.1651376146789, "16": 80.16666666666667, "21": 73.375, "4": 116.8, "8": 107.2, "12": 118.0, "6": 124.22727272727273, "14": 120.47368421052632, "18": 193.13333333333333, "22": 160.83333333333334, "17": 110.0, "9": 51.333333333333336, "5": 189.89743589743588, "13": 76.0, "1": 36.86842105263158}, "Microlearning vaccines": {"4": 153.578125, "14": 186.64556962025316, "19": 129.95833333333334, "9": 197.9, "20": 55.666666666666664, "15": 69.0, "21": 86.0, "13": 106.2, "18": 84.5, "17": 219.0, "22": 322.0, "8": 51.0, "5": 58.0, "10": 121.0}, "Motivational interviewing": {"4": 199.0, "8": 233.81553398058253, "12": 124.72727272727273, "16": 123.42857142857143, "20": 137.0, "3": 231.72435897435898, "13": 229.92307692307693, "18": 164.72222222222223, "19": 183.33333333333334, "5": 99.75, "9": 137.8, "17": 117.28571428571429, "21": 130.25, "7": 128.05, "11": 118.9375, "15": 196.71428571428572, "14": 106.0, "6": 123.0, "10": 82.0, "22": 99.8, "1": 32.43956043956044}, "Visit check in": {"5": 280.0652173913044, "9": 240.25, "13": 135.25, "17": 388.55172413793105, "21": 207.66666666666666, "12": 260.8073394495413, "22": 262.95454545454544, "10": 1951.7777777777778, "18": 118.14285714285714, "6": 134.83333333333334, "14": 149.0, "4": 278.30434782608694, "8": 216.76190476190476, "16": 270.6842105263158, "20": 199.8125, "15": 138.4, "19": 176.75, "2": 256.4117647058824, "7": 442.17721518987344, "11": 199.28571428571428, "3": 472.0}, "Unknown": {"1": 36.77157360406091, "2": 69.77319587628865, "3": 61.56353591160221, "4": 69.5909090909091, "5": 58.20710059171598, "6": 51.05625, "7": 60.70886075949367, "8": 53.38709677419355, "9": 51.96026490066225, "10": 52.054054054054056, "11": 51.60958904109589, "12": 46.471014492753625, "13": 57.06106870229008, "14": 50.422764227642276, "15": 47.321100917431195, "16": 50.98936170212766, "17": 50.120879120879124, "18": 41.383720930232556, "19": 43.36470588235294, "20": 50.50632911392405, "21": 37.54054054054054, "22": 37.7}}, "by_method_version": {"Scenario_V3": {}, "Scenario_V4": {"1": 72.05, "6": 90.0, "10": 115.33333333333333, "14": 89.0, "18": 102.5, "22": 138.33333333333334, "7": 85.66666666666667, "11": 163.66666666666666, "15": 82.66666666666667, "19": 94.0, "5": 124.80952380952381, "9": 129.57894736842104, "13": 137.94117647058823, "17": 151.16666666666666, "21": 159.91666666666666, "16": 120.0, "20": 65.0, "2": 57.4, "3": 81.0, "8": 61.5, "12": 68.5}, "Scenario_V5": {"1": 191.08387096774194, "2": 199.36666666666667, "6": 214.3764705882353, "8": 208.0909090909091, "9": 215.40740740740742, "10": 157.65217391304347, "11": 186.27777777777777, "16": 177.5, "3": 219.26923076923077, "4": 163.29166666666666, "5": 202.0625, "7": 187.2941176470588, "12": 194.25, "17": 134.5, "15": 216.5}, "Scenario_V6": {"21": 230.5681818181818, "16": 174.9375, "17": 79.33333333333333, "22": 108.0, "11": 154.48076923076923, "6": 223.48333333333332, "1": 156.875, "20": 103.66666666666667, "19": 202.0, "15": 137.0, "2": 339.6666666666667, "7": 236.0, "12": 564.0}, "Microlearning_V3": {}, "Microlearning_V4": {"2": 90.6875, "3": 73.3076923076923, "7": 88.33333333333333, "11": 74.33333333333333, "15": 82.4, "19": 149.8, "4": 116.8, "8": 118.5, "12": 118.0, "16": 78.0, "20": 143.0, "6": 121.55, "10": 119.70588235294117, "14": 80.57142857142857, "18": 179.85714285714286, "22": 165.45454545454547, "17": 110.0, "21": 82.6, "9": 62.5, "5": 77.33333333333333, "13": 76.0, "1": 36.86842105263158}, "Microlearning_V5": {"7": 359.5483870967742, "15": 153.11764705882354, "2": 196.64705882352942, "10": 223.57894736842104, "5": 174.47826086956522, "11": 109.0, "16": 129.5, "14": 301.3333333333333, "6": 92.0, "9": 29.0, "8": 62.0}, "Microlearning_V6": {"20": 199.73333333333332, "15": 165.16216216216216, "16": 33.0, "21": 58.0, "10": 172.6851851851852, "5": 203.21153846153845, "22": 110.0, "19": 97.75, "18": 379.0, "14": 128.5, "6": 210.0, "11": 57.0}, "Microlearning vaccines_V3": {}, "Microlearning vaccines_V4": {}, "Microlearning vaccines_V5": {"4": 151.5529411764706, "14": 205.0681818181818, "9": 161.71794871794873, "15": 69.0, "13": 132.66666666666666, "8": 51.0, "5": 47.0}, "Microlearning vaccines_V6": {"19": 129.95833333333334, "14": 163.4857142857143, "20": 55.666666666666664, "9": 221.0327868852459, "4": 157.58139534883722, "21": 86.0, "18": 84.5, "17": 219.0, "22": 322.0, "13": 66.5, "5": 69.0, "10": 121.0}, "Motivational interviewing_V3": {}, "Motivational interviewing_V4": {"4": 141.8, "8": 111.75, "12": 106.33333333333333, "16": 91.16666666666667, "20": 135.0, "5": 99.75, "9": 178.33333333333334, "13": 72.33333333333333, "17": 85.66666666666667, "21": 85.0, "3": 143.16666666666666, "7": 128.05, "11": 118.9375, "15": 196.71428571428572, "19": 203.07142857142858, "14": 52.5, "18": 76.5, "6": 123.0, "10": 82.0, "22": 102.5, "1": 32.43956043956044}, "Motivational interviewing_V5": {"3": 263.69, "13": 269.1489361702128, "8": 258.0, "14": 159.5, "12": 171.5, "4": 81.0, "9": 85.0}, "Motivational interviewing_V6": {"18": 171.78, "13": 196.4878048780488, "19": 114.25, "8": 228.21875, "3": 198.25, "20": 142.0, "17": 141.0, "22": 89.0, "16": 317.0, "21": 266.0, "12": 48.0, "4": 603.0, "9": 69.0}, "Visit check in_V3": {"6": 137.5, "16": 103.0, "4": 101.0, "20": 65.0}, "Visit check in_V4": {"5": 89.33333333333333, "9": 240.25, "13": 123.0, "17": 129.16666666666666, "21": 194.0, "6": 143.0, "10": 130.0, "14": 149.0, "18": 165.0, "22": 155.66666666666666, "4": 286.3636363636364, "8": 209.8, "12": 165.875, "16": 296.57142857142856, "20": 156.28571428571428, "15": 67.25, "19": 118.66666666666667, "7": 87.0, "11": 51.0}, "Visit check in_V5": {"5": 308.675, "12": 328.375, "17": 176.75, "10": 2862.6666666666665, "2": 273.2542372881356, "7": 323.7, "13": 166.0, "11": 224.0, "16": 448.0, "3": 472.0, "6": 105.0}, "Visit check in_V6": {"22": 270.8048780487805, "17": 491.0, "18": 99.4, "12": 222.48888888888888, "7": 470.46268656716416, "2": 218.19230769230768, "16": 146.66666666666666, "21": 235.0, "19": 351.0, "15": 423.0, "20": 944.0, "8": 356.0, "13": 135.0}, "Unknown_V3": {"1": 69.3862433862434, "2": 71.94117647058823, "3": 62.22346368715084, "4": 71.06395348837209, "5": 58.862275449101794, "6": 51.68354430379747, "7": 61.0828025477707, "8": 53.701298701298704, "9": 52.63758389261745, "10": 52.38775510204081, "11": 52.18055555555556, "12": 47.11764705882353, "13": 57.69767441860465, "14": 51.231404958677686, "15": 48.09345794392523, "16": 51.494623655913976, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 51.76623376623377, "21": 38.513888888888886, "22": 38.89655172413793}, "Unknown_V4": {"1": 30.563947633434037, "2": 11.857142857142858, "3": 2.5, "4": 6.25, "19": 2.0, "20": 2.0, "21": 2.5, "22": 3.0, "9": 1.5, "11": 10.5, "12": 2.5, "13": 16.0, "14": 1.5, "15": 6.0, "17": 2.0, "5": 3.5, "6": 1.5, "16": 4.0, "7": 2.0, "8": 5.0, "10": 3.0}, "Unknown_V5": {}, "Unknown_V6": {"19": 50.0}}, "by_version": {"V3": {"1": 69.3862433862434, "2": 71.94117647058823, "3": 62.22346368715084, "4": 71.23699421965318, "5": 58.862275449101794, "6": 52.75625, "7": 61.0828025477707, "8": 53.701298701298704, "9": 52.63758389261745, "10": 52.38775510204081, "11": 52.18055555555556, "12": 47.11764705882353, "13": 57.69767441860465, "14": 51.231404958677686, "15": 48.09345794392523, "16": 52.04255319148936, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 51.93589743589744, "21": 38.513888888888886, "22": 38.89655172413793}, "V4": {"1": 34.90257648953301, "2": 74.36363636363636, "3": 111.875, "4": 211.61111111111111, "5": 105.41666666666667, "6": 110.69444444444444, "7": 110.125, "8": 169.19354838709677, "9": 136.2, "10": 114.35714285714286, "11": 104.0, "12": 131.07142857142858, "13": 117.32142857142857, "14": 82.35714285714286, "15": 131.96428571428572, "16": 200.73076923076923, "17": 122.3076923076923, "18": 144.96153846153845, "19": 159.23076923076923, "20": 128.76923076923077, "21": 129.53846153846155, "22": 135.56521739130434}, "V5": {"1": 191.08387096774194, "2": 229.5142857142857, "3": 256.23622047244095, "4": 153.47272727272727, "5": 238.26041666666666, "6": 211.71264367816093, "7": 276.68, "8": 228.71428571428572, "9": 179.9558823529412, "10": 437.2835820895522, "11": 188.72131147540983, "12": 307.5892857142857, "13": 257.3076923076923, "14": 209.10204081632654, "15": 149.89743589743588, "16": 184.48, "17": 170.71428571428572}, "V6": {"18": 163.38333333333333, "19": 130.32203389830508, "20": 198.03703703703704, "21": 218.45098039215685, "22": 257.39130434782606, "16": 168.97368421052633, "17": 430.4375, "13": 189.1818181818182, "14": 161.59459459459458, "15": 170.2, "8": 230.1846153846154, "9": 218.58064516129033, "10": 171.74545454545455, "11": 152.64150943396226, "12": 226.04255319148936, "6": 223.2622950819672, "7": 467.0147058823529, "1": 156.875, "2": 230.75862068965517, "3": 198.25, "4": 167.70454545454547, "5": 200.67924528301887}}};
        const progressionDataFiltered = {"by_method": {"Scenario": {"1": 133.6095890410959, "6": 180.13103448275862, "10": 148.89655172413794, "14": 89.0, "18": 102.5, "22": 126.2, "2": 159.4857142857143, "8": 192.0, "9": 179.95652173913044, "11": 156.42857142857142, "16": 156.83928571428572, "21": 173.3090909090909, "3": 163.65384615384616, "4": 163.29166666666666, "5": 171.45283018867926, "17": 136.52941176470588, "7": 179.05405405405406, "15": 136.42857142857142, "19": 130.0, "13": 137.94117647058823, "20": 84.33333333333333, "12": 152.33333333333334}, "Microlearning": {"2": 139.05128205128204, "3": 73.3076923076923, "7": 156.08333333333334, "11": 76.5, "15": 137.3783783783784, "19": 126.66666666666667, "20": 197.31914893617022, "10": 145.72115384615384, "16": 80.16666666666667, "21": 73.375, "4": 116.8, "8": 107.2, "12": 118.0, "6": 120.14285714285714, "14": 120.47368421052632, "18": 193.13333333333333, "22": 160.83333333333334, "17": 110.0, "9": 51.333333333333336, "5": 149.72602739726028, "13": 76.0, "1": 36.86842105263158}, "Microlearning vaccines": {"4": 122.55284552845528, "14": 139.77333333333334, "19": 129.95833333333334, "9": 136.19791666666666, "20": 55.666666666666664, "15": 69.0, "21": 86.0, "13": 106.2, "18": 84.5, "17": 219.0, "22": 322.0, "8": 51.0, "5": 47.0}, "Motivational interviewing": {"4": 96.6, "8": 172.4742268041237, "12": 124.72727272727273, "16": 123.42857142857143, "20": 137.0, "13": 190.4659090909091, "18": 164.72222222222223, "3": 167.18382352941177, "19": 129.1875, "5": 99.75, "9": 137.8, "17": 117.28571428571429, "21": 130.25, "7": 128.05, "11": 118.9375, "15": 176.53846153846155, "14": 106.0, "6": 123.0, "10": 82.0, "22": 99.8, "1": 32.43956043956044}, "Visit check in": {"5": 214.1590909090909, "9": 240.25, "13": 135.25, "17": 214.82142857142858, "21": 207.66666666666666, "12": 219.0952380952381, "22": 194.85, "10": 307.25, "18": 118.14285714285714, "6": 134.83333333333334, "14": 149.0, "4": 180.23809523809524, "8": 177.73684210526315, "16": 150.47058823529412, "20": 199.8125, "15": 138.4, "19": 176.75, "7": 214.68571428571428, "2": 226.98765432098764, "11": 199.28571428571428}, "Unknown": {"1": 36.563928873835735, "2": 56.84126984126984, "3": 54.89772727272727, "4": 54.64705882352941, "5": 57.07784431137725, "6": 51.05625, "7": 49.53896103896104, "8": 53.38709677419355, "9": 50.346666666666664, "10": 48.703448275862065, "11": 51.60958904109589, "12": 46.471014492753625, "13": 55.46923076923077, "14": 50.422764227642276, "15": 47.321100917431195, "16": 50.98936170212766, "17": 50.120879120879124, "18": 41.383720930232556, "19": 43.36470588235294, "20": 46.8974358974359, "21": 37.54054054054054, "22": 35.898305084745765}}, "by_method_version": {"Scenario_V3": {}, "Scenario_V4": {"1": 68.92436974789916, "6": 90.0, "10": 115.33333333333333, "14": 89.0, "18": 102.5, "22": 138.33333333333334, "7": 85.66666666666667, "15": 82.66666666666667, "19": 94.0, "5": 124.80952380952381, "9": 129.57894736842104, "13": 137.94117647058823, "17": 151.16666666666666, "21": 159.91666666666666, "16": 120.0, "20": 65.0, "2": 57.4, "3": 81.0, "8": 61.5, "12": 68.5, "11": 71.5}, "Scenario_V5": {"1": 181.5234899328859, "2": 178.14285714285714, "6": 180.0126582278481, "8": 200.15625, "9": 215.40740740740742, "10": 157.65217391304347, "11": 161.7450980392157, "16": 134.52380952380952, "3": 166.96, "4": 163.29166666666666, "5": 202.0625, "7": 187.2941176470588, "12": 194.25, "17": 134.5, "15": 216.5}, "Scenario_V6": {"21": 177.04651162790697, "16": 174.9375, "17": 79.33333333333333, "22": 108.0, "11": 154.48076923076923, "6": 190.98305084745763, "1": 156.875, "20": 103.66666666666667, "19": 202.0, "15": 137.0, "2": 153.5}, "Microlearning_V3": {}, "Microlearning_V4": {"2": 90.6875, "3": 73.3076923076923, "7": 88.33333333333333, "11": 74.33333333333333, "15": 82.4, "19": 149.8, "4": 116.8, "8": 118.5, "12": 118.0, "16": 78.0, "20": 143.0, "6": 121.55, "10": 98.6875, "14": 80.57142857142857, "18": 179.85714285714286, "22": 165.45454545454547, "17": 110.0, "21": 82.6, "9": 62.5, "5": 77.33333333333333, "13": 76.0, "1": 36.86842105263158}, "Microlearning_V5": {"7": 169.63333333333333, "15": 153.11764705882354, "2": 172.69565217391303, "10": 167.1891891891892, "5": 174.47826086956522, "11": 109.0, "16": 129.5, "14": 301.3333333333333, "6": 92.0, "9": 29.0, "8": 62.0}, "Microlearning_V6": {"20": 199.73333333333332, "15": 129.94285714285715, "16": 33.0, "21": 58.0, "10": 144.90196078431373, "5": 142.2340425531915, "22": 110.0, "19": 97.75, "18": 379.0, "14": 128.5, "11": 57.0}, "Microlearning vaccines_V3": {}, "Microlearning vaccines_V4": {}, "Microlearning vaccines_V5": {"4": 117.97560975609755, "14": 142.609756097561, "9": 149.26315789473685, "15": 69.0, "13": 132.66666666666666, "8": 51.0, "5": 47.0}, "Microlearning vaccines_V6": {"19": 129.95833333333334, "14": 136.35294117647058, "20": 55.666666666666664, "9": 127.63793103448276, "4": 131.70731707317074, "21": 86.0, "18": 84.5, "17": 219.0, "22": 322.0, "13": 66.5}, "Motivational interviewing_V3": {}, "Motivational interviewing_V4": {"4": 100.5, "8": 111.75, "12": 106.33333333333333, "16": 91.16666666666667, "20": 135.0, "5": 99.75, "9": 178.33333333333334, "13": 72.33333333333333, "17": 85.66666666666667, "21": 85.0, "3": 129.95652173913044, "7": 128.05, "11": 118.9375, "15": 176.53846153846155, "19": 134.16666666666666, "14": 52.5, "18": 76.5, "6": 123.0, "10": 82.0, "22": 102.5, "1": 32.43956043956044}, "Motivational interviewing_V5": {"13": 216.47826086956522, "8": 173.03125, "3": 175.6024096385542, "14": 159.5, "12": 171.5, "4": 81.0, "9": 85.0}, "Motivational interviewing_V6": {"18": 171.78, "13": 168.87179487179486, "19": 114.25, "8": 176.1639344262295, "3": 172.43333333333334, "20": 142.0, "17": 141.0, "22": 89.0, "16": 317.0, "21": 266.0, "12": 48.0, "9": 69.0}, "Visit check in_V3": {"6": 137.5, "16": 103.0, "4": 101.0, "20": 65.0}, "Visit check in_V4": {"5": 89.33333333333333, "9": 240.25, "13": 123.0, "17": 129.16666666666666, "21": 194.0, "6": 143.0, "10": 130.0, "14": 149.0, "18": 165.0, "22": 155.66666666666666, "4": 184.2, "8": 177.73684210526315, "12": 165.875, "16": 130.58333333333334, "20": 156.28571428571428, "15": 67.25, "19": 118.66666666666667, "7": 87.0, "11": 51.0}, "Visit check in_V5": {"5": 233.8684210526316, "12": 257.97777777777776, "17": 176.75, "10": 413.6, "7": 253.66666666666666, "13": 166.0, "2": 231.14545454545456, "11": 224.0, "16": 448.0, "6": 105.0}, "Visit check in_V6": {"22": 198.02702702702703, "17": 240.3684210526316, "18": 99.4, "12": 198.6818181818182, "7": 213.0677966101695, "2": 218.19230769230768, "16": 146.66666666666666, "21": 235.0, "19": 351.0, "15": 423.0, "20": 944.0, "13": 135.0}, "Unknown_V3": {"1": 68.25531914893617, "2": 58.57142857142857, "3": 55.5, "4": 55.81325301204819, "5": 57.72727272727273, "6": 51.68354430379747, "7": 49.849673202614376, "8": 53.701298701298704, "9": 51.00675675675676, "10": 49.020833333333336, "11": 52.18055555555556, "12": 47.11764705882353, "13": 56.0859375, "14": 51.231404958677686, "15": 48.09345794392523, "16": 51.494623655913976, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 48.078947368421055, "21": 38.513888888888886, "22": 37.05263157894737}, "Unknown_V4": {"1": 30.563947633434037, "2": 11.857142857142858, "3": 2.5, "4": 6.25, "19": 2.0, "20": 2.0, "21": 2.5, "22": 3.0, "9": 1.5, "11": 10.5, "12": 2.5, "13": 16.0, "14": 1.5, "15": 6.0, "17": 2.0, "5": 3.5, "6": 1.5, "16": 4.0, "7": 2.0, "8": 5.0, "10": 3.0}, "Unknown_V5": {}, "Unknown_V6": {"19": 50.0}}, "by_version": {"V3": {"1": 68.25531914893617, "2": 58.57142857142857, "3": 55.5, "4": 56.08383233532934, "5": 57.72727272727273, "6": 52.75625, "7": 49.849673202614376, "8": 53.701298701298704, "9": 51.00675675675676, "10": 49.020833333333336, "11": 52.18055555555556, "12": 47.11764705882353, "13": 56.0859375, "14": 51.231404958677686, "15": 48.09345794392523, "16": 52.04255319148936, "17": 51.20224719101124, "18": 41.383720930232556, "19": 44.292682926829265, "20": 48.298701298701296, "21": 38.513888888888886, "22": 37.05263157894737}, "V4": {"1": 34.57292506043513, "2": 74.36363636363636, "3": 103.28205128205128, "4": 142.27272727272728, "5": 105.41666666666667, "6": 110.69444444444444, "7": 110.125, "8": 147.53333333333333, "9": 136.2, "10": 101.70370370370371, "11": 94.96296296296296, "12": 131.07142857142858, "13": 117.32142857142857, "14": 82.35714285714286, "15": 119.85185185185185, "16": 109.75, "17": 122.3076923076923, "18": 144.96153846153845, "19": 121.125, "20": 128.76923076923077, "21": 129.53846153846155, "22": 135.56521739130434}, "V5": {"1": 181.5234899328859, "2": 198.7984496124031, "4": 127.79439252336448, "5": 206.5212765957447, "6": 178.0, "7": 188.21917808219177, "8": 182.65151515151516, "9": 173.16417910447763, "10": 182.76923076923077, "11": 167.27586206896552, "12": 246.64150943396226, "13": 209.5686274509804, "14": 153.69565217391303, "15": 149.89743589743588, "16": 147.16666666666666, "17": 170.71428571428572, "3": 173.60185185185185}, "V6": {"18": 163.38333333333333, "19": 130.32203389830508, "20": 198.03703703703704, "21": 172.18, "22": 192.0, "16": 168.97368421052633, "17": 220.7608695652174, "13": 163.1904761904762, "14": 135.91666666666666, "15": 138.02631578947367, "8": 176.1639344262295, "9": 126.64406779661017, "10": 144.90196078431373, "11": 152.64150943396226, "12": 195.33333333333334, "6": 190.98305084745763, "7": 213.0677966101695, "1": 156.875, "2": 213.57142857142858, "3": 172.43333333333334, "4": 131.70731707317074, "5": 142.2340425531915}}};
        
        let progressionChart = null;
        
        function toggleOutlierFilter() {
            // This function would need to be implemented to recalculate data with outlier filtering
            // For now, it's a placeholder that could trigger a page reload or AJAX call
            console.log('Outlier filter toggled - this would require server-side recalculation');
        }
        
        function updateProgressionChart() {
            const view = document.getElementById('progressionView').value;
            const excludeOutliers = document.getElementById('excludeOutliersProgression').checked;
            const data = excludeOutliers ? progressionDataFiltered[view] : progressionData[view];
            
            if (progressionChart) {
                progressionChart.destroy();
            }
            
            const ctx = document.getElementById('progressionChart').getContext('2d');
            
            // Prepare datasets
            const datasets = [];
            const colors = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', 
                '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384'
            ];
            
            let colorIndex = 0;
            for (const [key, values] of Object.entries(data)) {
                if (Object.keys(values).length === 0) continue;
                
                const sessionNumbers = Object.keys(values).map(Number).sort((a, b) => a - b);
                const wordCounts = sessionNumbers.map(sessionNum => values[sessionNum] || 0);
                
                datasets.push({
                    label: key,
                    data: wordCounts.map((count, index) => ({
                        x: sessionNumbers[index],
                        y: count
                    })),
                    borderColor: colors[colorIndex % colors.length],
                    backgroundColor: colors[colorIndex % colors.length] + '20',
                    tension: 0.1,
                    fill: false
                });
                colorIndex++;
            }
            
            progressionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Session Number'
                            },
                            min: 1,
                            max: 22
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Average Words per Session'
                            },
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        title: {
                            display: true,
                            text: 'User Verbosity Progression Across Sessions'
                        }
                    }
                }
            });
        }
        
        // Initialize chart on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateProgressionChart();
        });
    </script>
</body>
</html>
        